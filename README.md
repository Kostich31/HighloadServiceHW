# Telegram
# 1. Тема и целевая аудитория
### Тема
Мессенджер **Telegram** - кроссплатформенная система мгновенного обмена сообщениями, позволяющая обмениваться текстовыми, голосовыми и видеосообщениями, стикерами и фотографиями, файлами многих форматов.
### Функционал MVP
- регистрация по номеру телефона
- отправка текстовых сообщений
- отправка голосовых сообщений
- отправка фотографий
- список чатов
- история сообщений
### Целевая аудитория
Ниже представлена статистика исследования аудитории Telegram. В опросе приняли участие жители из более чем 70 стран. [[1]](https://tgstat.ru/research-2021)
Возраст целевой аудитории варьируется в диапазоне от 18 до 64 лет
Возрастная группа | Процентное соотношение
------------ | -------------
до 17 лет | 7,7%
18-24 года| 21,9% 
25-34 года| 30,6% 
35-44 года| 21,3% 
45-64 года| 18,5% 

Размер целевой аудитории: 550 млн. пользователей в месяц, 55 млн. пользователей в день. [[2]](https://www.demandsage.com/telegram-statistics/)

Общемировая география пользователей:  Азия (38%), Европа (27%), Латинская Америка (21%), страны MENA (8%). [[3]](https://www.businessofapps.com/data/telegram-statistics/)

География русскоязычных пользователей: Россия – 60%, Беларусь – 17%, Украина – 13%.

# 2. Расчёт нагрузки

### Продуктовые метрики
Ежемесячная аудитория Telegram: 550 млн. пользователей.

Ежедневная аудитория Telegram: 55 млн. пользователей.

Количество отправленных сообщений в день: 15 миллиардов.

Средняя длительность сессии: 6 минут.

Количество регистраций в день: 1.5 млн. [[4]](https://expandedramblings.com/index.php/telegram-stats/)

Количество заходов в день: 24 [[5]](https://www.tadviser.ru/index.php/Статья:Мессенджеры_(Instant_Messenger,_IM)#:~:text=Как%20выяснилось%2C%20в%20среднем%20пользователь,идут%20Viber%2C%20Telegram%20и%20Skype.)

#### Хранилище данных для пользователя
Посчитаем количество сообщений в день на одного пользователя : 15 млрд. / 55 млн. = 272
Пусть:
  - Из 272 сообщений 5 будут голосовыми и 5 будут фотографиями.
  - Средняя длина одного сообщения равна 20 символам в кодировки UTF-8, где 1 символ равен 1 байту.
  - Средняя длина записи одного голосового сообщения равна 60 секундам, битрейт равен 128 kbps, тогда размер будет равен 960 кБ.
  - Средний размер одной фотографии равен 1 Мб.
  - Сообщения хранятся 5 лет

Тогда общий объем **сообщений**, отправляемых в день, на одного пользователя равен: 262 * 0.002(кБ) + 5 * 960(кБ) + 5 * 1024(кБ) = 9920 кБ

Средний размер **профиля** пользователя составляет 1 Мб (аватарка + данные о пользователе(номер телефона, уникальный идентификатор, имя).

Суммарный объем данных на одного пользователя за 5 лет: 9920(кБ) * 365 * 5 + 1024(кБ) = 18.1 гБ

#### Сетевой трафик
Основная нагрузка приходится на сообщения, рассмотрим трафик по типам сообщений:
    Тип          | Отправка (дневная аудитория 55 млн) | Отправка Тб/сутки | Получение (из личных чатов, возьмем эмпирический коэффициент) Тб/сутки             |
   ------------- |--------------------------------------|-------------------|-----------------------------------------------------------------------------------|
   Текстовое     | 262 * 55 млн. * 0.002 кБ             | 0.026             | 0.026 * 4 = 0.104                                                                 |
   Голосовое     | 5 * 55 млн. * 960 кБ                 | 246               | 246 * 2 = 492                                                                     |
   Фотография    | 5 * 55 млн. * 1024 кБ                | 262               | 262 * 2 = 524                                                                     |

Итого: 1524.13 Тб/сутки или 0.018 Тб/cек

#### RPS
 
 - Отправка сообщения: 55 млн * 272 / 86400 = 173 148 RPS
 - Получение сообщения: 55 млн * 272 * 4 / 86400 = 692 592 RPS
 - Регистрация: 1.5 млн / 86400 = 17 RPS
 - Получение списка чатов: 55 млн. * 24 / 86400 = 15 278 RPS

   Действие                            | RPS
   ------------------------------------| ---
   Отправка сообщения                  | 173 148
   Получение сообщения                 | 692 592
   Регистрация                         | 17
   Получение списка чатов              | 15 278
   **Итого**                           | 881 035


# 8. Ссылки на источники
1. https://tgstat.ru/research-2021
2. https://www.demandsage.com/telegram-statistics/
3. https://www.businessofapps.com/data/telegram-statistics/
4. https://expandedramblings.com/index.php/telegram-stats/
5. https://www.tadviser.ru/index.php/Статья:Мессенджеры_(Instant_Messenger,_IM)#:~:text=Как%20выяснилось%2C%20в%20среднем%20пользователь,идут%20Viber%2C%20Telegram%20и%20Skype.
